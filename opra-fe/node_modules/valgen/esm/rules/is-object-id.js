import validatorJS from 'validator';
import { validator } from '../core/index.js';
/**
 * Validates if value is an "ObjectId".
 * @validator isObjectId
 */
export function isObjectId(options) {
    return validator('isObjectId', function (input, context, _this) {
        if (input != null &&
            (_isObjectIdValue(input) ||
                (typeof input === 'object' &&
                    typeof input.toHexString === 'function' &&
                    _isObjectIdValue(input.toHexString()))))
            return input;
        context.fail(_this, `{{label}} must be an ObjectId`, input);
    }, options);
}
function _isObjectIdValue(input) {
    return (input instanceof Uint8Array && input.length === 12) ||
        (typeof input === 'string' && input.length === 24 && validatorJS.isHexadecimal(input));
}
