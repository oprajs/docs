import { ResponsiveMap } from '../../helpers/index.js';
import { CrudOperation } from './crud-operation.js';
import { Resource } from './resource.js';
export class CrudResource extends Resource {
    constructor(parent, init) {
        super(parent, init);
        this.operations = new ResponsiveMap();
        if (init.operations) {
            for (const [name, meta] of Object.entries(init.operations)) {
                this.operations.set(name, new CrudOperation(this, name, meta));
            }
        }
    }
    getOperation(operation) {
        const op = this.operations.get(operation);
        if (!op)
            throw new Error(`${this.name} resource does not support "${operation}" operations`);
        return op;
    }
    exportSchema(options) {
        const schema = super.exportSchema(options);
        if (this.operations.size) {
            schema.operations = {};
            for (const operation of this.operations.values()) {
                schema.operations[operation.name] = operation.exportSchema(options);
            }
        }
        return schema;
    }
}
