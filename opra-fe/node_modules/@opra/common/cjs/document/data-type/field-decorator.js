"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.FieldDecorator = void 0;
const index_js_1 = require("../../helpers/index.js");
const index_js_2 = require("../../schema/index.js");
const constants_js_1 = require("../constants.js");
function FieldDecorator(options) {
    return function (target, propertyKey) {
        if (typeof propertyKey !== 'string')
            throw new TypeError(`Symbol properties can't be used as a field`);
        const metadata = Reflect.getOwnMetadata(constants_js_1.DATATYPE_METADATA, target.constructor) || {};
        metadata.kind = index_js_2.OpraSchema.ComplexType.Kind;
        metadata.fields = metadata.fields || {};
        const designType = Reflect.getMetadata('design:type', target, propertyKey);
        const elemMeta = metadata.fields[propertyKey] = {
            ...options,
            designType
        };
        if (designType === Array) {
            elemMeta.isArray = true;
            delete elemMeta.designType;
        }
        Reflect.defineMetadata(constants_js_1.DATATYPE_METADATA, (0, index_js_1.omitUndefined)(metadata), target.constructor);
    };
}
exports.FieldDecorator = FieldDecorator;
