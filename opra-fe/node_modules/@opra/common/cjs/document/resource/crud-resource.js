"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CrudResource = void 0;
const index_js_1 = require("../../helpers/index.js");
const crud_operation_js_1 = require("./crud-operation.js");
const resource_js_1 = require("./resource.js");
class CrudResource extends resource_js_1.Resource {
    constructor(parent, init) {
        super(parent, init);
        this.operations = new index_js_1.ResponsiveMap();
        if (init.operations) {
            for (const [name, meta] of Object.entries(init.operations)) {
                this.operations.set(name, new crud_operation_js_1.CrudOperation(this, name, meta));
            }
        }
    }
    getOperation(operation) {
        const op = this.operations.get(operation);
        if (!op)
            throw new Error(`${this.name} resource does not support "${operation}" operations`);
        return op;
    }
    exportSchema(options) {
        const schema = super.exportSchema(options);
        if (this.operations.size) {
            schema.operations = {};
            for (const operation of this.operations.values()) {
                schema.operations[operation.name] = operation.exportSchema(options);
            }
        }
        return schema;
    }
}
exports.CrudResource = CrudResource;
