"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.convertToRawHeaders = void 0;
const match_known_fields_js_1 = require("./match-known-fields.js");
function convertToRawHeaders(src) {
    return Object.entries(src)
        .reduce((a, [field, v]) => {
        const [name, flag] = (0, match_known_fields_js_1.matchKnownFields)(field);
        if (flag === match_known_fields_js_1.ARRAY_FIELD) {
            if (Array.isArray(v))
                v.forEach(x => a.push(name, String(x)));
            else
                a.push(name, String(v));
            return a;
        }
        if (flag === match_known_fields_js_1.COMMA_DELIMITED_FIELD || flag === match_known_fields_js_1.SEMICOLON_DELIMITED_FIELD) {
            v = Array.isArray(v) ? v.join(flag === match_known_fields_js_1.COMMA_DELIMITED_FIELD ? ', ' : '; ') : String(v);
        }
        else
            v = Array.isArray(v) ? String(v[0]) : String(v);
        a.push(name, v);
        return a;
    }, []);
}
exports.convertToRawHeaders = convertToRawHeaders;
