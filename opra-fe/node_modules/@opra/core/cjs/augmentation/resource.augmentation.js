"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const common_1 = require("@opra/common");
// @ts-ignore
const oldConstruct = common_1.Resource.prototype._construct;
// @ts-ignore
common_1.Resource.prototype._construct = function (init) {
    oldConstruct.call(this, init);
    const _this = this;
    _this.onInit = init.onInit;
    _this.onShutdown = init.onShutdown;
};
common_1.Collection.OnInit = common_1.Singleton.OnInit = function () {
    return (target, propertyKey) => {
        const sourceMetadata = (Reflect.getOwnMetadata(common_1.RESOURCE_METADATA, target.constructor) || {});
        sourceMetadata.onInit = target[propertyKey];
        Reflect.defineMetadata(common_1.RESOURCE_METADATA, target.constructor, sourceMetadata);
    };
};
common_1.Collection.OnShutdown = common_1.Singleton.OnShutdown = function () {
    return (target, propertyKey) => {
        const sourceMetadata = (Reflect.getOwnMetadata(common_1.RESOURCE_METADATA, target.constructor) || {});
        sourceMetadata.onShutdown = target[propertyKey];
        Reflect.defineMetadata(common_1.RESOURCE_METADATA, target.constructor, sourceMetadata);
    };
};
